# Trading Platform Environment Variables
# Copy this file to .env and update the values for your environment

# Database Configuration
DATABASE_URL=postgresql://trading_user:trading_pass@localhost:5432/trading_db
DB_HOST=localhost
DB_PORT=5432
DB_NAME=trading_db
DB_USER=trading_user
DB_PASSWORD=trading_pass

# Redis Configuration
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379

# API Endpoints (for frontend)
NEXT_PUBLIC_MARKET_DATA_API=http://localhost:8002
NEXT_PUBLIC_ANALYSIS_API=http://localhost:8003

# Market Data API Configuration
MARKET_DATA_API_PORT=8002
MARKET_DATA_API_HOST=0.0.0.0

# Market Data Service Tuning
CACHE_TTL_SECONDS=5
WEBSOCKET_UPDATE_INTERVAL=5
MACRO_REFRESH_INTERVAL_SECONDS=900
MACRO_CACHE_TTL_SECONDS=300
OPTIONS_METRICS_CACHE_TTL=300
OPTIONS_METRICS_TTL=900

# Analysis API Configuration
ANALYSIS_API_PORT=8003
ANALYSIS_API_HOST=0.0.0.0

# External Market Data Providers (configure as needed)
ALPHA_VANTAGE_API_KEY=your_alpha_vantage_key_here
POLYGON_API_KEY=your_polygon_key_here
FINNHUB_API_KEY=your_finnhub_key_here
IEX_CLOUD_API_KEY=your_iex_cloud_key_here

# JWT Configuration
JWT_SECRET=your_super_secret_jwt_key_here
JWT_EXPIRATION=24h
JWT_REFRESH_EXPIRATION=7d

# Application Settings
NODE_ENV=development
LOG_LEVEL=info
CORS_ORIGIN=http://localhost:3000

# Alert Engine Settings
ALERT_CHECK_INTERVAL_SEC=60
ALERT_BATCH_SIZE=100

# Cache Settings
CACHE_DEFAULT_TTL_SEC=300
TECHNICAL_ANALYSIS_CACHE_TTL_SEC=3600
FORECAST_CACHE_TTL_SEC=14400

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Seed Data (for development)
SEED_DATA=false

# Observability
PROMETHEUS_PORT=9090
JAEGER_ENDPOINT=http://localhost:14268/api/traces

# Security
BCRYPT_ROUNDS=12
CORS_CREDENTIALS=true

EVENT_DB_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/event_data
EVENT_DB_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/event_data
EVENT_CALENDAR_URL=https://example.com/events.json
EVENT_CALENDAR_API_KEY=your-api-key-here
EVENT_CALENDAR_PROVIDER=sample-provider
EVENT_CALENDAR_POLL_INTERVAL=900
EVENT_HEADLINE_URL=https://example.com/headlines.json
EVENT_HEADLINE_API_KEY=your-headline-api-key
EVENT_HEADLINE_PROVIDER=sample-headline-provider
EVENT_HEADLINE_POLL_INTERVAL=120
EVENT_HEADLINE_MATCH_WINDOW_MINUTES=120
EVENT_CALENDAR_DEDUPE_WINDOW_MINUTES=60
EVENT_CALENDAR_MAX_HORIZON_DAYS=365
EVENT_CALENDAR_MIN_SYMBOL_LENGTH=1
EVENT_CALENDAR_ALLOWED_CATEGORIES=earnings,product_launch,analyst_day,regulatory
EVENT_CALENDAR_PROVIDERS_JSON=[{"name":"primary","url":"https://primary.example.com/events"},{"name":"backup","url":"https://backup.example.com/events"}]
EVENT_CALENDAR_PROVIDER_MAX_FAILURES=3
EVENT_CALENDAR_PROVIDER_FAILBACK_SECONDS=600
EVENT_CALENDAR_DEFAULT_IMPACT_SCORE=5
EVENT_CALENDAR_CATEGORY_IMPACTS={"earnings":8,"product_launch":6}
EVENT_CALENDAR_DEFAULT_IMPACT_SCORE=5
EVENT_CALENDAR_CATEGORY_IMPACTS={"earnings":8,"product_launch":6}
# Event webhook notifications
EVENT_WEBHOOK_URL=
EVENT_WEBHOOK_HEADERS={}
EVENT_WEBHOOK_TARGETS=
EVENT_WEBHOOK_TIMEOUT=5
# Event categorization overrides
EVENT_CATEGORY_OVERRIDES=

# Event clustering configuration
EVENT_CLUSTERING_RULES=
EVENT_SECTOR_MAPPING={"AAPL":"technology","MSFT":"technology","JPM":"financials"}
EVENT_SUPPLY_CHAIN_RELATIONSHIPS={"AAPL":["TSM","QCOM"],"TSLA":["PANW","LIT"]}

# Event Enrichment Configuration
# API keys for market data providers
FINNHUB_API_KEY=your_finnhub_api_key_here
ALPHA_VANTAGE_API_KEY=your_alpha_vantage_api_key_here

# Enrichment service settings
YAHOO_FINANCE_ENABLED=true
ENRICHMENT_CACHE_DURATION_MINUTES=30
ENRICHMENT_MAX_RETRIES=3
ENRICHMENT_TIMEOUT_SECONDS=5.0
ENRICHMENT_BATCH_SIZE=10

# Event Lifecycle Tracking Configuration
LIFECYCLE_MONITOR_INTERVAL_MINUTES=15
LIFECYCLE_ANALYSIS_DELAY_HOURS=24
LIFECYCLE_PRE_EVENT_WINDOW_HOURS=4
LIFECYCLE_POST_EVENT_WINDOW_HOURS=72

# Event Sentiment Analysis Configuration
EVENT_SENTIMENT_ENABLED=true
SENTIMENT_SERVICE_URL=http://localhost:8007
EVENT_SENTIMENT_TIMEOUT=30.0
EVENT_SENTIMENT_PRE_HOURS=24
EVENT_SENTIMENT_POST_HOURS=24
EVENT_SENTIMENT_WINDOW_HOURS=2

# Historical Data Backfill Configuration
BACKFILL_ENABLED=true
BACKFILL_MAX_CONCURRENT_SYMBOLS=3
BACKFILL_DEFAULT_LOOKBACK_DAYS=365
BACKFILL_MAX_DAYS_PER_REQUEST=90
BACKFILL_RATE_LIMIT_DELAY=1.0
BACKFILL_TIMEOUT=30.0
BACKFILL_RETRY_ATTEMPTS=3
BACKFILL_BATCH_SIZE=100

# Data Source API Keys for Backfill
FMP_API_KEY=your_financial_modeling_prep_api_key_here
ALPHA_VANTAGE_API_KEY=your_alpha_vantage_api_key_here
POLYGON_API_KEY=your_polygon_api_key_here
FINNHUB_API_KEY=your_finnhub_api_key_here

# ===== Data Retention and Archival Configuration =====
# Enable/disable data retention service
RETENTION_ENABLED=true

# Cleanup interval (hours between automatic cleanup runs)
RETENTION_CLEANUP_INTERVAL_HOURS=24

# Archive storage configuration
RETENTION_ARCHIVE_PATH=/data/archives
RETENTION_BATCH_SIZE=1000
RETENTION_MAX_PARALLEL=3

# Custom retention rules (JSON array)
# Format: [{"name":"custom_rule","category":"events","policy":"cold","age_days":90,"conditions":{"status":["completed"]},"archive_format":"json","archive_location":"custom_archive","enabled":true,"priority":1}]
RETENTION_CUSTOM_RULES=

# ===== Event Data Service Cache Configuration =====
# Enable/disable Redis caching
EVENT_CACHE_ENABLED=true

# Redis connection settings (inherits from main Redis config if not specified)
EVENT_CACHE_DB=1
EVENT_CACHE_TTL_SECONDS=3600
EVENT_CACHE_MAX_CONNECTIONS=10
EVENT_CACHE_KEY_PREFIX=event_cache

# Performance settings
EVENT_CACHE_COMPRESSION_THRESHOLD=1024
EVENT_CACHE_BATCH_SIZE=100
EVENT_CACHE_TIMEOUT=5.0

# ===== Bulk Ingestion Configuration =====
# Enable/disable bulk ingestion service
BULK_INGESTION_ENABLED=true

# File processing limits
BULK_INGESTION_MAX_FILE_SIZE_MB=500
BULK_INGESTION_TEMP_DIR=/tmp
BULK_INGESTION_BATCH_SIZE=1000
BULK_INGESTION_MAX_WORKERS=4

# Performance settings
BULK_INGESTION_MEMORY_LIMIT_MB=1024
BULK_INGESTION_CHUNK_SIZE=10000
BULK_INGESTION_VACUUM_THRESHOLD=100000
BULK_INGESTION_POOL_SIZE=20

# ===== Event Streaming Configuration =====
# Enable/disable real-time event streaming
EVENT_STREAMING_ENABLED=true

# Streaming backends (comma-separated: redis_streams, redis_pubsub, websocket, sse)
EVENT_STREAMING_BACKENDS=redis_streams,websocket,sse

# Redis configuration for streaming (inherits from main Redis config if not specified)
EVENT_STREAMING_REDIS_DB=2
EVENT_STREAMING_PREFIX=events

# Stream performance settings
EVENT_STREAMING_MAX_LENGTH=10000
EVENT_STREAMING_BATCH_SIZE=100
EVENT_STREAMING_TIMEOUT_MS=5000
EVENT_STREAMING_RETENTION_HOURS=24

# Connection limits
WS_MAX_CONNECTIONS=1000
SSE_MAX_CONNECTIONS=500
